Split: 21842 train, 501 dev, 500 test
Model name:BAAI/bge-m3-retromae
[2025-12-29 00:14:54,924] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-12-29 00:15:01,513] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
{'loss': 0.3433, 'grad_norm': 0.3565182387828827, 'learning_rate': 9.97076023391813e-06, 'epoch': 1.0}
{'eval_loss': 0.20039376616477966, 'eval_f1_micro': 0.48217317487266553, 'eval_best_threshold': 0.3, 'eval_runtime': 8.2034, 'eval_samples_per_second': 61.072, 'eval_steps_per_second': 1.95, 'epoch': 1.0}

================================================================================
Classification report — epoch 1
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.00      0.00      0.00        35
          ID       0.86      0.13      0.22        47
          IN       0.81      0.32      0.45       111
          IP       0.57      0.74      0.64       110
          LY       0.00      0.00      0.00        49
          MT       0.00      0.00      0.00         8
          NA       0.60      0.86      0.71       139
          OP       0.40      0.58      0.47        86
          SP       0.00      0.00      0.00        38
          av       0.00      0.00      0.00        36
          ds       0.44      0.87      0.58        53
         dtp       0.00      0.00      0.00        74
          ed       0.00      0.00      0.00        10
          en       0.00      0.00      0.00         3
          fi       0.00      0.00      0.00        11
          it       0.00      0.00      0.00        18
          lt       0.00      0.00      0.00         3
          nb       0.38      0.33      0.35        18
          ne       0.60      0.94      0.73        78
          ob       0.27      0.25      0.26        12
          ra       0.00      0.00      0.00         8
          re       0.00      0.00      0.00         7
          rs       0.00      0.00      0.00        16
          rv       1.00      0.12      0.22         8
          sr       0.62      0.56      0.59         9

   micro avg       0.55      0.43      0.48       987
   macro avg       0.26      0.23      0.21       987
weighted avg       0.41      0.43      0.38       987
 samples avg       0.50      0.40      0.42       987

================================================================================

{'loss': 0.1385, 'grad_norm': 0.30898556113243103, 'learning_rate': 1.997076023391813e-05, 'epoch': 2.0}
{'eval_loss': 0.14548945426940918, 'eval_f1_micro': 0.6384330333509793, 'eval_best_threshold': 0.3, 'eval_runtime': 7.7786, 'eval_samples_per_second': 64.408, 'eval_steps_per_second': 2.057, 'epoch': 2.0}

================================================================================
Classification report — epoch 2
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.59      0.49      0.53        35
          ID       0.86      0.26      0.39        47
          IN       0.56      0.61      0.59       111
          IP       0.64      0.69      0.66       110
          LY       0.84      0.76      0.80        49
          MT       0.43      0.38      0.40         8
          NA       0.75      0.82      0.78       139
          OP       0.69      0.40      0.50        86
          SP       0.92      0.87      0.89        38
          av       0.79      0.31      0.44        36
          ds       0.55      0.85      0.67        53
         dtp       0.53      0.43      0.48        74
          ed       0.00      0.00      0.00        10
          en       0.17      0.33      0.22         3
          fi       0.00      0.00      0.00        11
          it       0.59      0.89      0.71        18
          lt       1.00      0.33      0.50         3
          nb       0.40      0.44      0.42        18
          ne       0.89      0.81      0.85        78
          ob       0.67      0.17      0.27        12
          ra       1.00      0.25      0.40         8
          re       1.00      1.00      1.00         7
          rs       0.48      0.69      0.56        16
          rv       1.00      0.38      0.55         8
          sr       0.64      0.78      0.70         9

   micro avg       0.67      0.61      0.64       987
   macro avg       0.64      0.52      0.53       987
weighted avg       0.68      0.61      0.62       987
 samples avg       0.62      0.57      0.57       987

================================================================================

{'loss': 0.1052, 'grad_norm': 0.32021191716194153, 'learning_rate': 1.984896242675837e-05, 'epoch': 3.0}
{'eval_loss': 0.13430292904376984, 'eval_f1_micro': 0.6670035371399696, 'eval_best_threshold': 0.3, 'eval_runtime': 7.7791, 'eval_samples_per_second': 64.404, 'eval_steps_per_second': 2.057, 'epoch': 3.0}

================================================================================
Classification report — epoch 3
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.62      0.74      0.68        35
          ID       0.75      0.51      0.61        47
          IN       0.64      0.70      0.67       111
          IP       0.67      0.69      0.68       110
          LY       0.84      0.86      0.85        49
          MT       0.50      0.12      0.20         8
          NA       0.80      0.80      0.80       139
          OP       0.53      0.60      0.57        86
          SP       0.82      0.84      0.83        38
          av       0.56      0.28      0.37        36
          ds       0.57      0.91      0.70        53
         dtp       0.61      0.50      0.55        74
          ed       0.00      0.00      0.00        10
          en       0.20      0.33      0.25         3
          fi       1.00      0.09      0.17        11
          it       0.68      0.72      0.70        18
          lt       1.00      0.33      0.50         3
          nb       0.50      0.28      0.36        18
          ne       0.83      0.81      0.82        78
          ob       0.25      0.08      0.12        12
          ra       1.00      0.88      0.93         8
          re       0.78      1.00      0.88         7
          rs       0.27      0.75      0.40        16
          rv       0.83      0.62      0.71         8
          sr       0.78      0.78      0.78         9

   micro avg       0.67      0.67      0.67       987
   macro avg       0.64      0.57      0.56       987
weighted avg       0.67      0.67      0.66       987
 samples avg       0.63      0.62      0.60       987

================================================================================

{'loss': 0.0851, 'grad_norm': 1.0649698972702026, 'learning_rate': 1.9398670416179636e-05, 'epoch': 4.0}
{'eval_loss': 0.12478964775800705, 'eval_f1_micro': 0.6911917098445596, 'eval_best_threshold': 0.3, 'eval_runtime': 7.7769, 'eval_samples_per_second': 64.422, 'eval_steps_per_second': 2.057, 'epoch': 4.0}

================================================================================
Classification report — epoch 4
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.58      0.89      0.70        35
          ID       0.89      0.36      0.52        47
          IN       0.62      0.71      0.66       111
          IP       0.73      0.60      0.66       110
          LY       0.86      0.76      0.80        49
          MT       0.57      0.50      0.53         8
          NA       0.81      0.85      0.83       139
          OP       0.62      0.64      0.63        86
          SP       0.85      0.87      0.86        38
          av       0.59      0.53      0.56        36
          ds       0.74      0.79      0.76        53
         dtp       0.55      0.51      0.53        74
          ed       0.00      0.00      0.00        10
          en       0.00      0.00      0.00         3
          fi       0.86      0.55      0.67        11
          it       0.86      0.67      0.75        18
          lt       1.00      0.33      0.50         3
          nb       0.44      0.22      0.30        18
          ne       0.80      0.90      0.84        78
          ob       0.40      0.17      0.24        12
          ra       1.00      0.75      0.86         8
          re       1.00      0.86      0.92         7
          rs       0.50      0.69      0.58        16
          rv       0.83      0.62      0.71         8
          sr       1.00      0.56      0.71         9

   micro avg       0.71      0.68      0.69       987
   macro avg       0.68      0.57      0.61       987
weighted avg       0.71      0.68      0.68       987
 samples avg       0.66      0.62      0.61       987

================================================================================

{'loss': 0.0696, 'grad_norm': 0.28773894906044006, 'learning_rate': 1.866280456096199e-05, 'epoch': 5.0}
{'eval_loss': 0.13062074780464172, 'eval_f1_micro': 0.685250886974151, 'eval_best_threshold': 0.3, 'eval_runtime': 7.7775, 'eval_samples_per_second': 64.417, 'eval_steps_per_second': 2.057, 'epoch': 5.0}

================================================================================
Classification report — epoch 5
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.76      0.71      0.74        35
          ID       0.74      0.60      0.66        47
          IN       0.60      0.75      0.66       111
          IP       0.62      0.70      0.66       110
          LY       0.84      0.84      0.84        49
          MT       0.50      0.12      0.20         8
          NA       0.84      0.80      0.82       139
          OP       0.61      0.43      0.50        86
          SP       0.84      0.84      0.84        38
          av       0.61      0.39      0.47        36
          ds       0.64      0.91      0.75        53
         dtp       0.48      0.62      0.54        74
          ed       1.00      0.10      0.18        10
          en       0.00      0.00      0.00         3
          fi       0.89      0.73      0.80        11
          it       0.93      0.78      0.85        18
          lt       1.00      0.33      0.50         3
          nb       0.38      0.28      0.32        18
          ne       0.82      0.87      0.84        78
          ob       0.43      0.25      0.32        12
          ra       0.78      0.88      0.82         8
          re       1.00      0.86      0.92         7
          rs       0.57      0.50      0.53        16
          rv       0.83      0.62      0.71         8
          sr       0.88      0.78      0.82         9

   micro avg       0.69      0.68      0.69       987
   macro avg       0.70      0.59      0.61       987
weighted avg       0.69      0.68      0.68       987
 samples avg       0.66      0.63      0.62       987

================================================================================

{'loss': 0.0573, 'grad_norm': 1.1129230260849, 'learning_rate': 1.7663723772750138e-05, 'epoch': 6.0}
{'eval_loss': 0.12799260020256042, 'eval_f1_micro': 0.7051546391752578, 'eval_best_threshold': 0.35, 'eval_runtime': 7.7787, 'eval_samples_per_second': 64.407, 'eval_steps_per_second': 2.057, 'epoch': 6.0}

================================================================================
Classification report — epoch 6
Best threshold: 0.35
              precision    recall  f1-score   support

          HI       0.72      0.80      0.76        35
          ID       0.79      0.70      0.74        47
          IN       0.57      0.79      0.66       111
          IP       0.72      0.70      0.71       110
          LY       0.90      0.76      0.82        49
          MT       0.67      0.25      0.36         8
          NA       0.81      0.84      0.82       139
          OP       0.65      0.49      0.56        86
          SP       0.91      0.82      0.86        38
          av       0.71      0.33      0.45        36
          ds       0.85      0.74      0.79        53
         dtp       0.56      0.62      0.59        74
          ed       1.00      0.30      0.46        10
          en       0.00      0.00      0.00         3
          fi       0.86      0.55      0.67        11
          it       0.85      0.61      0.71        18
          lt       1.00      0.33      0.50         3
          nb       0.42      0.28      0.33        18
          ne       0.83      0.90      0.86        78
          ob       0.43      0.25      0.32        12
          ra       0.78      0.88      0.82         8
          re       1.00      0.86      0.92         7
          rs       0.47      0.50      0.48        16
          rv       0.83      0.62      0.71         8
          sr       0.64      0.78      0.70         9

   micro avg       0.72      0.69      0.71       987
   macro avg       0.72      0.59      0.63       987
weighted avg       0.73      0.69      0.70       987
 samples avg       0.66      0.63      0.62       987

================================================================================

{'loss': 0.0464, 'grad_norm': 0.960759162902832, 'learning_rate': 1.6431784615734616e-05, 'epoch': 7.0}
{'eval_loss': 0.13164155185222626, 'eval_f1_micro': 0.7019867549668874, 'eval_best_threshold': 0.5499999999999999, 'eval_runtime': 7.7785, 'eval_samples_per_second': 64.408, 'eval_steps_per_second': 2.057, 'epoch': 7.0}

================================================================================
Classification report — epoch 7
Best threshold: 0.55
              precision    recall  f1-score   support

          HI       0.79      0.77      0.78        35
          ID       0.85      0.62      0.72        47
          IN       0.72      0.61      0.66       111
          IP       0.67      0.67      0.67       110
          LY       0.88      0.71      0.79        49
          MT       0.67      0.25      0.36         8
          NA       0.83      0.83      0.83       139
          OP       0.71      0.47      0.56        86
          SP       0.86      0.84      0.85        38
          av       0.62      0.36      0.46        36
          ds       0.76      0.74      0.75        53
         dtp       0.69      0.47      0.56        74
          ed       0.83      0.50      0.62        10
          en       0.00      0.00      0.00         3
          fi       1.00      0.55      0.71        11
          it       0.92      0.61      0.73        18
          lt       1.00      0.33      0.50         3
          nb       0.56      0.28      0.37        18
          ne       0.84      0.83      0.84        78
          ob       1.00      0.17      0.29        12
          ra       1.00      0.62      0.77         8
          re       0.86      0.86      0.86         7
          rs       0.73      0.50      0.59        16
          rv       0.83      0.62      0.71         8
          sr       0.70      0.78      0.74         9

   micro avg       0.77      0.64      0.70       987
   macro avg       0.77      0.56      0.63       987
weighted avg       0.77      0.64      0.69       987
 samples avg       0.68      0.60      0.62       987

================================================================================

{'loss': 0.0376, 'grad_norm': 2.1083366870880127, 'learning_rate': 1.5004418937810057e-05, 'epoch': 8.0}
{'eval_loss': 0.13711148500442505, 'eval_f1_micro': 0.7123695976154992, 'eval_best_threshold': 0.35, 'eval_runtime': 7.7801, 'eval_samples_per_second': 64.395, 'eval_steps_per_second': 2.057, 'epoch': 8.0}

================================================================================
Classification report — epoch 8
Best threshold: 0.35
              precision    recall  f1-score   support

          HI       0.74      0.80      0.77        35
          ID       0.89      0.68      0.77        47
          IN       0.62      0.68      0.65       111
          IP       0.63      0.85      0.72       110
          LY       0.87      0.84      0.85        49
          MT       0.50      0.25      0.33         8
          NA       0.84      0.81      0.82       139
          OP       0.66      0.60      0.63        86
          SP       0.82      0.84      0.83        38
          av       0.60      0.58      0.59        36
          ds       0.61      0.92      0.74        53
         dtp       0.54      0.55      0.55        74
          ed       0.67      0.60      0.63        10
          en       0.00      0.00      0.00         3
          fi       0.78      0.64      0.70        11
          it       0.75      0.83      0.79        18
          lt       0.50      0.33      0.40         3
          nb       0.38      0.28      0.32        18
          ne       0.85      0.85      0.85        78
          ob       0.60      0.25      0.35        12
          ra       0.86      0.75      0.80         8
          re       1.00      0.71      0.83         7
          rs       0.56      0.62      0.59        16
          rv       0.71      0.62      0.67         8
          sr       0.64      0.78      0.70         9

   micro avg       0.70      0.73      0.71       987
   macro avg       0.66      0.63      0.64       987
weighted avg       0.70      0.73      0.71       987
 samples avg       0.66      0.66      0.64       987

================================================================================

{'loss': 0.0299, 'grad_norm': 0.2518749535083771, 'learning_rate': 1.342499652281831e-05, 'epoch': 9.0}
{'eval_loss': 0.14476877450942993, 'eval_f1_micro': 0.694781233526621, 'eval_best_threshold': 0.39999999999999997, 'eval_runtime': 7.7794, 'eval_samples_per_second': 64.401, 'eval_steps_per_second': 2.057, 'epoch': 9.0}

================================================================================
Classification report — epoch 9
Best threshold: 0.40
              precision    recall  f1-score   support

          HI       0.74      0.89      0.81        35
          ID       0.84      0.66      0.74        47
          IN       0.68      0.59      0.63       111
          IP       0.61      0.80      0.69       110
          LY       0.89      0.65      0.75        49
          MT       0.50      0.25      0.33         8
          NA       0.85      0.81      0.83       139
          OP       0.67      0.58      0.62        86
          SP       0.86      0.82      0.84        38
          av       0.61      0.47      0.53        36
          ds       0.66      0.87      0.75        53
         dtp       0.69      0.39      0.50        74
          ed       0.50      0.20      0.29        10
          en       0.00      0.00      0.00         3
          fi       0.88      0.64      0.74        11
          it       0.88      0.78      0.82        18
          lt       1.00      0.33      0.50         3
          nb       0.40      0.22      0.29        18
          ne       0.84      0.81      0.82        78
          ob       0.57      0.33      0.42        12
          ra       0.71      0.62      0.67         8
          re       1.00      0.71      0.83         7
          rs       0.50      0.50      0.50        16
          rv       0.83      0.62      0.71         8
          sr       0.64      0.78      0.70         9

   micro avg       0.72      0.67      0.69       987
   macro avg       0.69      0.57      0.61       987
weighted avg       0.73      0.67      0.69       987
 samples avg       0.66      0.62      0.61       987

================================================================================

{'loss': 0.0235, 'grad_norm': 0.5003343224525452, 'learning_rate': 1.1741507321612593e-05, 'epoch': 10.0}
{'eval_loss': 0.14559881389141083, 'eval_f1_micro': 0.7096103896103896, 'eval_best_threshold': 0.3, 'eval_runtime': 7.7782, 'eval_samples_per_second': 64.411, 'eval_steps_per_second': 2.057, 'epoch': 10.0}

================================================================================
Classification report — epoch 10
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.82      0.89      0.85        35
          ID       0.79      0.79      0.79        47
          IN       0.75      0.59      0.66       111
          IP       0.59      0.81      0.68       110
          LY       0.85      0.84      0.85        49
          MT       0.67      0.25      0.36         8
          NA       0.79      0.85      0.82       139
          OP       0.61      0.59      0.60        86
          SP       0.89      0.82      0.85        38
          av       0.61      0.39      0.47        36
          ds       0.74      0.66      0.70        53
         dtp       0.69      0.49      0.57        74
          ed       0.45      0.50      0.48        10
          en       0.00      0.00      0.00         3
          fi       0.86      0.55      0.67        11
          it       0.93      0.72      0.81        18
          lt       1.00      0.33      0.50         3
          nb       0.55      0.33      0.41        18
          ne       0.85      0.86      0.85        78
          ob       0.67      0.33      0.44        12
          ra       0.83      0.62      0.71         8
          re       1.00      0.71      0.83         7
          rs       0.53      0.56      0.55        16
          rv       0.83      0.62      0.71         8
          sr       0.64      0.78      0.70         9

   micro avg       0.73      0.69      0.71       987
   macro avg       0.72      0.60      0.64       987
weighted avg       0.73      0.69      0.70       987
 samples avg       0.66      0.63      0.62       987

================================================================================

{'loss': 0.0186, 'grad_norm': 0.43577897548675537, 'learning_rate': 1.0005103301684903e-05, 'epoch': 11.0}
{'eval_loss': 0.14863623678684235, 'eval_f1_micro': 0.7125382262996942, 'eval_best_threshold': 0.35, 'eval_runtime': 7.7777, 'eval_samples_per_second': 64.415, 'eval_steps_per_second': 2.057, 'epoch': 11.0}

================================================================================
Classification report — epoch 11
Best threshold: 0.35
              precision    recall  f1-score   support

          HI       0.72      0.89      0.79        35
          ID       0.84      0.68      0.75        47
          IN       0.61      0.69      0.65       111
          IP       0.67      0.77      0.72       110
          LY       0.84      0.78      0.81        49
          MT       0.67      0.50      0.57         8
          NA       0.82      0.86      0.84       139
          OP       0.65      0.52      0.58        86
          SP       0.79      0.87      0.82        38
          av       0.58      0.42      0.48        36
          ds       0.77      0.81      0.79        53
         dtp       0.62      0.50      0.55        74
          ed       0.44      0.40      0.42        10
          en       0.00      0.00      0.00         3
          fi       0.89      0.73      0.80        11
          it       0.83      0.83      0.83        18
          lt       1.00      0.33      0.50         3
          nb       0.46      0.33      0.39        18
          ne       0.84      0.86      0.85        78
          ob       0.50      0.33      0.40        12
          ra       0.88      0.88      0.88         8
          re       1.00      0.86      0.92         7
          rs       0.56      0.62      0.59        16
          rv       0.83      0.62      0.71         8
          sr       0.54      0.78      0.64         9

   micro avg       0.72      0.71      0.71       987
   macro avg       0.69      0.63      0.65       987
weighted avg       0.71      0.71      0.71       987
 samples avg       0.66      0.65      0.63       987

================================================================================

{'loss': 0.0146, 'grad_norm': 0.3422367572784424, 'learning_rate': 8.268544220517914e-06, 'epoch': 12.0}
{'eval_loss': 0.1493271142244339, 'eval_f1_micro': 0.7149460708782742, 'eval_best_threshold': 0.3, 'eval_runtime': 7.7982, 'eval_samples_per_second': 64.246, 'eval_steps_per_second': 2.052, 'epoch': 12.0}

================================================================================
Classification report — epoch 12
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.73      0.86      0.79        35
          ID       0.87      0.72      0.79        47
          IN       0.64      0.69      0.66       111
          IP       0.64      0.81      0.71       110
          LY       0.86      0.78      0.82        49
          MT       0.67      0.50      0.57         8
          NA       0.84      0.81      0.83       139
          OP       0.64      0.55      0.59        86
          SP       0.72      0.87      0.79        38
          av       0.61      0.47      0.53        36
          ds       0.72      0.81      0.76        53
         dtp       0.68      0.54      0.60        74
          ed       0.46      0.60      0.52        10
          en       0.00      0.00      0.00         3
          fi       0.89      0.73      0.80        11
          it       0.88      0.83      0.86        18
          lt       1.00      0.33      0.50         3
          nb       0.44      0.22      0.30        18
          ne       0.87      0.83      0.85        78
          ob       1.00      0.17      0.29        12
          ra       0.83      0.62      0.71         8
          re       1.00      0.86      0.92         7
          rs       0.54      0.44      0.48        16
          rv       0.83      0.62      0.71         8
          sr       0.58      0.78      0.67         9

   micro avg       0.72      0.71      0.71       987
   macro avg       0.72      0.62      0.64       987
weighted avg       0.73      0.71      0.71       987
 samples avg       0.66      0.65      0.63       987

================================================================================

{'loss': 0.0116, 'grad_norm': 0.27851513028144836, 'learning_rate': 6.584594547051586e-06, 'epoch': 13.0}
{'eval_loss': 0.15457479655742645, 'eval_f1_micro': 0.7101077475628528, 'eval_best_threshold': 0.3, 'eval_runtime': 7.7785, 'eval_samples_per_second': 64.408, 'eval_steps_per_second': 2.057, 'epoch': 13.0}

================================================================================
Classification report — epoch 13
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.79      0.86      0.82        35
          ID       0.82      0.70      0.76        47
          IN       0.68      0.68      0.68       111
          IP       0.67      0.76      0.71       110
          LY       0.86      0.76      0.80        49
          MT       0.67      0.25      0.36         8
          NA       0.82      0.84      0.83       139
          OP       0.59      0.63      0.61        86
          SP       0.88      0.74      0.80        38
          av       0.56      0.50      0.53        36
          ds       0.72      0.81      0.76        53
         dtp       0.59      0.50      0.54        74
          ed       0.50      0.40      0.44        10
          en       0.00      0.00      0.00         3
          fi       0.86      0.55      0.67        11
          it       0.93      0.72      0.81        18
          lt       1.00      0.33      0.50         3
          nb       0.55      0.33      0.41        18
          ne       0.85      0.86      0.85        78
          ob       0.50      0.33      0.40        12
          ra       0.83      0.62      0.71         8
          re       1.00      0.86      0.92         7
          rs       0.50      0.62      0.56        16
          rv       0.71      0.62      0.67         8
          sr       0.54      0.78      0.64         9

   micro avg       0.72      0.70      0.71       987
   macro avg       0.70      0.60      0.63       987
weighted avg       0.72      0.70      0.71       987
 samples avg       0.65      0.63      0.62       987

================================================================================

{'loss': 0.0096, 'grad_norm': 0.5493615865707397, 'learning_rate': 5.0044202399945456e-06, 'epoch': 14.0}
{'eval_loss': 0.1587098389863968, 'eval_f1_micro': 0.7012987012987013, 'eval_best_threshold': 0.44999999999999996, 'eval_runtime': 7.7816, 'eval_samples_per_second': 64.383, 'eval_steps_per_second': 2.056, 'epoch': 14.0}

================================================================================
Classification report — epoch 14
Best threshold: 0.45
              precision    recall  f1-score   support

          HI       0.70      0.89      0.78        35
          ID       0.81      0.74      0.78        47
          IN       0.63      0.69      0.66       111
          IP       0.67      0.71      0.69       110
          LY       0.88      0.71      0.79        49
          MT       0.67      0.25      0.36         8
          NA       0.82      0.81      0.82       139
          OP       0.62      0.57      0.59        86
          SP       0.89      0.82      0.85        38
          av       0.52      0.39      0.44        36
          ds       0.74      0.79      0.76        53
         dtp       0.58      0.51      0.55        74
          ed       0.60      0.30      0.40        10
          en       0.00      0.00      0.00         3
          fi       0.86      0.55      0.67        11
          it       0.88      0.83      0.86        18
          lt       1.00      0.33      0.50         3
          nb       0.38      0.17      0.23        18
          ne       0.86      0.82      0.84        78
          ob       0.80      0.33      0.47        12
          ra       0.83      0.62      0.71         8
          re       1.00      0.86      0.92         7
          rs       0.55      0.69      0.61        16
          rv       0.83      0.62      0.71         8
          sr       0.64      0.78      0.70         9

   micro avg       0.72      0.68      0.70       987
   macro avg       0.71      0.59      0.63       987
weighted avg       0.72      0.68      0.69       987
 samples avg       0.66      0.63      0.62       987

================================================================================

{'loss': 0.0081, 'grad_norm': 0.6292250752449036, 'learning_rate': 3.5760340960599417e-06, 'epoch': 15.0}
{'eval_loss': 0.16377821564674377, 'eval_f1_micro': 0.7033855482566953, 'eval_best_threshold': 0.3, 'eval_runtime': 7.7829, 'eval_samples_per_second': 64.372, 'eval_steps_per_second': 2.056, 'epoch': 15.0}

================================================================================
Classification report — epoch 15
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.70      0.86      0.77        35
          ID       0.78      0.77      0.77        47
          IN       0.61      0.69      0.65       111
          IP       0.65      0.75      0.69       110
          LY       0.88      0.78      0.83        49
          MT       0.67      0.25      0.36         8
          NA       0.80      0.83      0.82       139
          OP       0.60      0.60      0.60        86
          SP       0.80      0.84      0.82        38
          av       0.50      0.39      0.44        36
          ds       0.67      0.81      0.74        53
         dtp       0.65      0.50      0.56        74
          ed       0.50      0.40      0.44        10
          en       0.00      0.00      0.00         3
          fi       0.80      0.73      0.76        11
          it       0.83      0.83      0.83        18
          lt       1.00      0.33      0.50         3
          nb       0.55      0.33      0.41        18
          ne       0.86      0.86      0.86        78
          ob       0.57      0.33      0.42        12
          ra       0.83      0.62      0.71         8
          re       0.86      0.86      0.86         7
          rs       0.50      0.62      0.56        16
          rv       0.71      0.62      0.67         8
          sr       0.58      0.78      0.67         9

   micro avg       0.70      0.71      0.70       987
   macro avg       0.68      0.62      0.63       987
weighted avg       0.70      0.71      0.70       987
 samples avg       0.65      0.64      0.62       987

================================================================================

{'train_runtime': 21080.9343, 'train_samples_per_second': 20.722, 'train_steps_per_second': 0.324, 'train_loss': 0.06659486056768406, 'epoch': 15.0}

===== TEST SET CLASSIFICATION REPORT =====
              precision    recall  f1-score   support

          HI       0.59      0.83      0.69        35
          ID       0.80      0.68      0.74        47
          IN       0.68      0.62      0.65       110
          IP       0.73      0.76      0.74       111
          LY       0.87      0.94      0.90        50
          MT       1.00      0.33      0.50         9
          NA       0.84      0.85      0.84       139
          OP       0.62      0.49      0.55        87
          SP       0.92      0.92      0.92        38
          av       0.65      0.54      0.59        37
          ds       0.80      0.85      0.82        52
         dtp       0.69      0.39      0.50        74
          ed       0.50      0.27      0.35        11
          en       0.00      0.00      0.00         3
          fi       1.00      0.45      0.62        11
          it       0.88      0.79      0.83        19
          lt       0.50      0.33      0.40         3
          nb       0.87      0.76      0.81        17
          ne       0.86      0.85      0.85        78
          ob       0.60      0.25      0.35        12
          ra       0.83      0.62      0.71         8
          re       0.71      1.00      0.83         5
          rs       0.67      0.25      0.36        16
          rv       1.00      0.62      0.77         8
          sr       0.89      0.80      0.84        10

   micro avg       0.76      0.69      0.73       990
   macro avg       0.74      0.61      0.65       990
weighted avg       0.76      0.69      0.71       990
 samples avg       0.67      0.62      0.62       990

Done!
