Split: 1401 train, 300 dev, 301 test
Model name:BAAI/bge-m3-retromae
[2025-12-26 21:49:34,186] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-12-26 21:49:38,349] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
{'loss': 0.5067, 'grad_norm': 0.7840405106544495, 'learning_rate': 8.700000000000001e-06, 'epoch': 1.0}
{'eval_loss': 0.26433655619621277, 'eval_f1_micro': 0.06666666666666667, 'eval_best_threshold': 0.3, 'eval_runtime': 4.7236, 'eval_samples_per_second': 63.511, 'eval_steps_per_second': 2.117, 'epoch': 1.0}

================================================================================
Classification report — epoch 1
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.00      0.00      0.00        23
          ID       0.00      0.00      0.00        28
          IN       0.00      0.00      0.00        67
          IP       0.00      0.00      0.00        65
          LY       0.00      0.00      0.00        30
          MT       0.00      0.00      0.00         6
          NA       0.84      0.25      0.39        84
          OP       0.00      0.00      0.00        56
          SP       0.00      0.00      0.00        23
          av       0.00      0.00      0.00        22
          ds       0.00      0.00      0.00        31
         dtp       0.00      0.00      0.00        45
          ed       0.00      0.00      0.00         7
          en       0.00      0.00      0.00         2
          fi       0.00      0.00      0.00         8
          it       0.00      0.00      0.00        11
          lt       0.00      0.00      0.00         2
          nb       0.00      0.00      0.00        11
          ne       0.00      0.00      0.00        48
          ob       0.00      0.00      0.00         7
          ra       0.00      0.00      0.00         4
          re       0.00      0.00      0.00         4
          rs       0.00      0.00      0.00        10
          rv       0.00      0.00      0.00         5
          sr       0.00      0.00      0.00         6

   micro avg       0.84      0.03      0.07       605
   macro avg       0.03      0.01      0.02       605
weighted avg       0.12      0.03      0.05       605
 samples avg       0.07      0.03      0.04       605

================================================================================

{'loss': 0.2438, 'grad_norm': 1.6969854831695557, 'learning_rate': 9.94971750196908e-06, 'epoch': 2.0}
{'eval_loss': 0.21497873961925507, 'eval_f1_micro': 0.44082519001085774, 'eval_best_threshold': 0.3, 'eval_runtime': 4.6656, 'eval_samples_per_second': 64.3, 'eval_steps_per_second': 2.143, 'epoch': 2.0}

================================================================================
Classification report — epoch 2
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.00      0.00      0.00        23
          ID       0.00      0.00      0.00        28
          IN       0.42      0.37      0.40        67
          IP       0.71      0.52      0.60        65
          LY       0.79      0.73      0.76        30
          MT       0.00      0.00      0.00         6
          NA       0.66      0.79      0.72        84
          OP       0.00      0.00      0.00        56
          SP       0.58      0.96      0.72        23
          av       0.00      0.00      0.00        22
          ds       0.00      0.00      0.00        31
         dtp       0.00      0.00      0.00        45
          ed       0.00      0.00      0.00         7
          en       0.00      0.00      0.00         2
          fi       0.00      0.00      0.00         8
          it       0.00      0.00      0.00        11
          lt       0.00      0.00      0.00         2
          nb       0.00      0.00      0.00        11
          ne       0.79      0.71      0.75        48
          ob       0.00      0.00      0.00         7
          ra       0.00      0.00      0.00         4
          re       0.00      0.00      0.00         4
          rs       0.00      0.00      0.00        10
          rv       0.00      0.00      0.00         5
          sr       0.00      0.00      0.00         6

   micro avg       0.64      0.34      0.44       605
   macro avg       0.16      0.16      0.16       605
weighted avg       0.34      0.34      0.33       605
 samples avg       0.45      0.34      0.37       605

================================================================================

{'loss': 0.1976, 'grad_norm': 1.7648884057998657, 'learning_rate': 9.76397823059751e-06, 'epoch': 3.0}
{'eval_loss': 0.1838170439004898, 'eval_f1_micro': 0.573170731707317, 'eval_best_threshold': 0.35, 'eval_runtime': 4.6672, 'eval_samples_per_second': 64.278, 'eval_steps_per_second': 2.143, 'epoch': 3.0}

================================================================================
Classification report — epoch 3
Best threshold: 0.35
              precision    recall  f1-score   support

          HI       1.00      0.26      0.41        23
          ID       0.86      0.43      0.57        28
          IN       0.41      0.63      0.50        67
          IP       0.79      0.63      0.70        65
          LY       0.90      0.63      0.75        30
          MT       0.00      0.00      0.00         6
          NA       0.76      0.77      0.76        84
          OP       0.50      0.64      0.56        56
          SP       0.69      0.78      0.73        23
          av       0.75      0.27      0.40        22
          ds       0.73      0.52      0.60        31
         dtp       0.40      0.47      0.43        45
          ed       0.00      0.00      0.00         7
          en       0.00      0.00      0.00         2
          fi       0.00      0.00      0.00         8
          it       0.31      0.45      0.37        11
          lt       0.00      0.00      0.00         2
          nb       0.00      0.00      0.00        11
          ne       0.65      0.88      0.74        48
          ob       0.00      0.00      0.00         7
          ra       0.00      0.00      0.00         4
          re       0.00      0.00      0.00         4
          rs       0.00      0.00      0.00        10
          rv       0.00      0.00      0.00         5
          sr       0.00      0.00      0.00         6

   micro avg       0.61      0.54      0.57       605
   macro avg       0.35      0.29      0.30       605
weighted avg       0.58      0.54      0.54       605
 samples avg       0.54      0.50      0.49       605

================================================================================

{'loss': 0.1671, 'grad_norm': 0.924558162689209, 'learning_rate': 9.446408841868826e-06, 'epoch': 4.0}
{'eval_loss': 0.16255171597003937, 'eval_f1_micro': 0.6277372262773723, 'eval_best_threshold': 0.35, 'eval_runtime': 4.6677, 'eval_samples_per_second': 64.271, 'eval_steps_per_second': 2.142, 'epoch': 4.0}

================================================================================
Classification report — epoch 4
Best threshold: 0.35
              precision    recall  f1-score   support

          HI       0.75      0.39      0.51        23
          ID       0.81      0.61      0.69        28
          IN       0.59      0.63      0.61        67
          IP       0.64      0.71      0.67        65
          LY       1.00      0.70      0.82        30
          MT       0.00      0.00      0.00         6
          NA       0.85      0.75      0.80        84
          OP       0.67      0.50      0.57        56
          SP       0.82      0.78      0.80        23
          av       0.65      0.50      0.56        22
          ds       0.61      0.71      0.66        31
         dtp       0.49      0.53      0.51        45
          ed       0.00      0.00      0.00         7
          en       0.00      0.00      0.00         2
          fi       0.00      0.00      0.00         8
          it       0.67      0.55      0.60        11
          lt       0.00      0.00      0.00         2
          nb       0.00      0.00      0.00        11
          ne       0.82      0.77      0.80        48
          ob       0.00      0.00      0.00         7
          ra       0.00      0.00      0.00         4
          re       0.00      0.00      0.00         4
          rs       0.00      0.00      0.00        10
          rv       0.00      0.00      0.00         5
          sr       0.00      0.00      0.00         6

   micro avg       0.70      0.57      0.63       605
   macro avg       0.37      0.32      0.34       605
weighted avg       0.63      0.57      0.59       605
 samples avg       0.61      0.54      0.54       605

================================================================================

{'loss': 0.1441, 'grad_norm': 1.9326303005218506, 'learning_rate': 9.00579720335057e-06, 'epoch': 5.0}
{'eval_loss': 0.15407918393611908, 'eval_f1_micro': 0.6603284356093345, 'eval_best_threshold': 0.39999999999999997, 'eval_runtime': 4.6674, 'eval_samples_per_second': 64.276, 'eval_steps_per_second': 2.143, 'epoch': 5.0}

================================================================================
Classification report — epoch 5
Best threshold: 0.40
              precision    recall  f1-score   support

          HI       0.68      0.57      0.62        23
          ID       0.77      0.71      0.74        28
          IN       0.54      0.76      0.63        67
          IP       0.84      0.63      0.72        65
          LY       0.96      0.80      0.87        30
          MT       0.00      0.00      0.00         6
          NA       0.81      0.81      0.81        84
          OP       0.64      0.64      0.64        56
          SP       0.86      0.78      0.82        23
          av       0.59      0.45      0.51        22
          ds       0.70      0.68      0.69        31
         dtp       0.49      0.67      0.57        45
          ed       0.00      0.00      0.00         7
          en       0.00      0.00      0.00         2
          fi       0.00      0.00      0.00         8
          it       0.44      0.73      0.55        11
          lt       0.00      0.00      0.00         2
          nb       0.67      0.18      0.29        11
          ne       0.83      0.81      0.82        48
          ob       0.00      0.00      0.00         7
          ra       0.00      0.00      0.00         4
          re       1.00      0.25      0.40         4
          rs       0.00      0.00      0.00        10
          rv       0.00      0.00      0.00         5
          sr       0.00      0.00      0.00         6

   micro avg       0.69      0.63      0.66       605
   macro avg       0.43      0.38      0.39       605
weighted avg       0.65      0.63      0.63       605
 samples avg       0.63      0.57      0.58       605

================================================================================

{'loss': 0.125, 'grad_norm': 2.602189540863037, 'learning_rate': 8.454336041626106e-06, 'epoch': 6.0}
{'eval_loss': 0.1447584480047226, 'eval_f1_micro': 0.6759339704604691, 'eval_best_threshold': 0.3, 'eval_runtime': 4.6678, 'eval_samples_per_second': 64.27, 'eval_steps_per_second': 2.142, 'epoch': 6.0}

================================================================================
Classification report — epoch 6
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.76      0.70      0.73        23
          ID       0.89      0.61      0.72        28
          IN       0.72      0.61      0.66        67
          IP       0.70      0.75      0.73        65
          LY       0.87      0.90      0.89        30
          MT       0.00      0.00      0.00         6
          NA       0.72      0.87      0.78        84
          OP       0.68      0.64      0.66        56
          SP       0.82      0.78      0.80        23
          av       0.53      0.41      0.46        22
          ds       0.60      0.77      0.68        31
         dtp       0.54      0.33      0.41        45
          ed       0.00      0.00      0.00         7
          en       0.00      0.00      0.00         2
          fi       1.00      0.38      0.55         8
          it       0.78      0.64      0.70        11
          lt       0.00      0.00      0.00         2
          nb       0.80      0.36      0.50        11
          ne       0.69      0.88      0.77        48
          ob       0.00      0.00      0.00         7
          ra       0.00      0.00      0.00         4
          re       1.00      0.50      0.67         4
          rs       1.00      0.40      0.57        10
          rv       0.00      0.00      0.00         5
          sr       1.00      0.33      0.50         6

   micro avg       0.71      0.64      0.68       605
   macro avg       0.56      0.43      0.47       605
weighted avg       0.68      0.64      0.65       605
 samples avg       0.64      0.59      0.59       605

================================================================================

{'loss': 0.1083, 'grad_norm': 2.1013052463531494, 'learning_rate': 7.807285541807342e-06, 'epoch': 7.0}
{'eval_loss': 0.14289751648902893, 'eval_f1_micro': 0.69, 'eval_best_threshold': 0.3, 'eval_runtime': 4.6672, 'eval_samples_per_second': 64.278, 'eval_steps_per_second': 2.143, 'epoch': 7.0}

================================================================================
Classification report — epoch 7
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.65      0.74      0.69        23
          ID       0.81      0.79      0.80        28
          IN       0.59      0.78      0.67        67
          IP       0.72      0.77      0.75        65
          LY       0.93      0.90      0.92        30
          MT       0.00      0.00      0.00         6
          NA       0.85      0.80      0.82        84
          OP       0.57      0.57      0.57        56
          SP       0.73      0.83      0.78        23
          av       0.67      0.36      0.47        22
          ds       0.63      0.77      0.70        31
         dtp       0.50      0.76      0.60        45
          ed       0.00      0.00      0.00         7
          en       0.00      0.00      0.00         2
          fi       0.80      0.50      0.62         8
          it       0.53      0.73      0.62        11
          lt       0.00      0.00      0.00         2
          nb       0.75      0.27      0.40        11
          ne       0.86      0.79      0.83        48
          ob       0.00      0.00      0.00         7
          ra       1.00      0.50      0.67         4
          re       1.00      0.50      0.67         4
          rs       1.00      0.30      0.46        10
          rv       0.00      0.00      0.00         5
          sr       1.00      0.33      0.50         6

   micro avg       0.70      0.68      0.69       605
   macro avg       0.58      0.48      0.50       605
weighted avg       0.69      0.68      0.67       605
 samples avg       0.63      0.62      0.60       605

================================================================================

{'loss': 0.0946, 'grad_norm': 5.382218837738037, 'learning_rate': 7.08255106349043e-06, 'epoch': 8.0}
{'eval_loss': 0.138062983751297, 'eval_f1_micro': 0.6972639011473963, 'eval_best_threshold': 0.39999999999999997, 'eval_runtime': 4.667, 'eval_samples_per_second': 64.282, 'eval_steps_per_second': 2.143, 'epoch': 8.0}

================================================================================
Classification report — epoch 8
Best threshold: 0.40
              precision    recall  f1-score   support

          HI       0.76      0.57      0.65        23
          ID       0.91      0.75      0.82        28
          IN       0.77      0.49      0.60        67
          IP       0.68      0.80      0.73        65
          LY       0.90      0.90      0.90        30
          MT       0.00      0.00      0.00         6
          NA       0.82      0.85      0.83        84
          OP       0.71      0.64      0.67        56
          SP       0.73      0.83      0.78        23
          av       0.67      0.45      0.54        22
          ds       0.72      0.74      0.73        31
         dtp       0.64      0.40      0.49        45
          ed       0.33      0.14      0.20         7
          en       0.00      0.00      0.00         2
          fi       1.00      0.50      0.67         8
          it       0.57      0.73      0.64        11
          lt       0.00      0.00      0.00         2
          nb       0.50      0.27      0.35        11
          ne       0.75      0.83      0.79        48
          ob       0.50      0.14      0.22         7
          ra       1.00      0.50      0.67         4
          re       1.00      0.50      0.67         4
          rs       0.75      0.60      0.67        10
          rv       0.00      0.00      0.00         5
          sr       1.00      0.83      0.91         6

   micro avg       0.75      0.65      0.70       605
   macro avg       0.63      0.50      0.54       605
weighted avg       0.73      0.65      0.68       605
 samples avg       0.67      0.60      0.61       605

================================================================================

{'loss': 0.084, 'grad_norm': 3.2192649841308594, 'learning_rate': 6.3001876587147825e-06, 'epoch': 9.0}
{'eval_loss': 0.12995129823684692, 'eval_f1_micro': 0.7274261603375527, 'eval_best_threshold': 0.3, 'eval_runtime': 4.6668, 'eval_samples_per_second': 64.285, 'eval_steps_per_second': 2.143, 'epoch': 9.0}

================================================================================
Classification report — epoch 9
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.70      0.83      0.76        23
          ID       0.86      0.86      0.86        28
          IN       0.69      0.73      0.71        67
          IP       0.74      0.77      0.75        65
          LY       0.93      0.90      0.92        30
          MT       0.00      0.00      0.00         6
          NA       0.83      0.86      0.84        84
          OP       0.67      0.61      0.64        56
          SP       0.86      0.83      0.84        23
          av       0.58      0.50      0.54        22
          ds       0.72      0.74      0.73        31
         dtp       0.57      0.62      0.60        45
          ed       0.00      0.00      0.00         7
          en       0.00      0.00      0.00         2
          fi       0.80      0.50      0.62         8
          it       0.80      0.73      0.76        11
          lt       0.00      0.00      0.00         2
          nb       0.50      0.36      0.42        11
          ne       0.78      0.83      0.81        48
          ob       1.00      0.14      0.25         7
          ra       1.00      0.50      0.67         4
          re       0.67      0.50      0.57         4
          rs       0.67      0.60      0.63        10
          rv       1.00      0.40      0.57         5
          sr       1.00      1.00      1.00         6

   micro avg       0.74      0.71      0.73       605
   macro avg       0.65      0.55      0.58       605
weighted avg       0.73      0.71      0.71       605
 samples avg       0.67      0.63      0.63       605

================================================================================

{'loss': 0.0748, 'grad_norm': 2.0124220848083496, 'learning_rate': 5.481845103040887e-06, 'epoch': 10.0}
{'eval_loss': 0.1349068284034729, 'eval_f1_micro': 0.7082658022690438, 'eval_best_threshold': 0.3, 'eval_runtime': 4.6671, 'eval_samples_per_second': 64.28, 'eval_steps_per_second': 2.143, 'epoch': 10.0}

================================================================================
Classification report — epoch 10
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.71      0.74      0.72        23
          ID       0.88      0.82      0.85        28
          IN       0.68      0.67      0.68        67
          IP       0.62      0.85      0.71        65
          LY       0.93      0.83      0.88        30
          MT       0.00      0.00      0.00         6
          NA       0.80      0.87      0.83        84
          OP       0.57      0.61      0.59        56
          SP       0.77      0.87      0.82        23
          av       0.58      0.64      0.61        22
          ds       0.63      0.84      0.72        31
         dtp       0.65      0.58      0.61        45
          ed       0.67      0.29      0.40         7
          en       0.00      0.00      0.00         2
          fi       0.80      0.50      0.62         8
          it       0.50      0.82      0.62        11
          lt       0.00      0.00      0.00         2
          nb       0.40      0.36      0.38        11
          ne       0.77      0.85      0.81        48
          ob       0.33      0.14      0.20         7
          ra       1.00      0.50      0.67         4
          re       0.67      0.50      0.57         4
          rs       0.67      0.60      0.63        10
          rv       0.67      0.40      0.50         5
          sr       1.00      1.00      1.00         6

   micro avg       0.69      0.72      0.71       605
   macro avg       0.61      0.57      0.58       605
weighted avg       0.69      0.72      0.70       605
 samples avg       0.64      0.65      0.62       605

================================================================================

{'loss': 0.0668, 'grad_norm': 0.6942564249038696, 'learning_rate': 4.650168796999736e-06, 'epoch': 11.0}
{'eval_loss': 0.13296160101890564, 'eval_f1_micro': 0.7192982456140351, 'eval_best_threshold': 0.3, 'eval_runtime': 4.6678, 'eval_samples_per_second': 64.27, 'eval_steps_per_second': 2.142, 'epoch': 11.0}

================================================================================
Classification report — epoch 11
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.66      0.83      0.73        23
          ID       0.89      0.86      0.87        28
          IN       0.68      0.70      0.69        67
          IP       0.68      0.83      0.75        65
          LY       0.88      0.93      0.90        30
          MT       0.00      0.00      0.00         6
          NA       0.77      0.88      0.82        84
          OP       0.54      0.70      0.61        56
          SP       0.86      0.83      0.84        23
          av       0.63      0.55      0.59        22
          ds       0.65      0.77      0.71        31
         dtp       0.61      0.60      0.61        45
          ed       0.75      0.43      0.55         7
          en       0.00      0.00      0.00         2
          fi       0.80      0.50      0.62         8
          it       0.89      0.73      0.80        11
          lt       0.00      0.00      0.00         2
          nb       0.42      0.73      0.53        11
          ne       0.75      0.83      0.79        48
          ob       0.50      0.43      0.46         7
          ra       1.00      0.50      0.67         4
          re       0.50      0.50      0.50         4
          rs       0.50      0.60      0.55        10
          rv       0.67      0.40      0.50         5
          sr       1.00      1.00      1.00         6

   micro avg       0.69      0.75      0.72       605
   macro avg       0.63      0.60      0.60       605
weighted avg       0.69      0.75      0.71       605
 samples avg       0.65      0.66      0.64       605

================================================================================

{'loss': 0.0615, 'grad_norm': 2.1778564453125, 'learning_rate': 3.828173116333925e-06, 'epoch': 12.0}
{'eval_loss': 0.13237975537776947, 'eval_f1_micro': 0.722495894909688, 'eval_best_threshold': 0.3, 'eval_runtime': 4.6666, 'eval_samples_per_second': 64.287, 'eval_steps_per_second': 2.143, 'epoch': 12.0}

================================================================================
Classification report — epoch 12
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.70      0.83      0.76        23
          ID       0.89      0.86      0.87        28
          IN       0.73      0.67      0.70        67
          IP       0.66      0.82      0.73        65
          LY       0.90      0.90      0.90        30
          MT       0.00      0.00      0.00         6
          NA       0.82      0.87      0.84        84
          OP       0.64      0.62      0.63        56
          SP       0.74      0.87      0.80        23
          av       0.63      0.55      0.59        22
          ds       0.65      0.77      0.71        31
         dtp       0.67      0.58      0.62        45
          ed       0.50      0.43      0.46         7
          en       0.00      0.00      0.00         2
          fi       0.80      0.50      0.62         8
          it       0.56      0.82      0.67        11
          lt       0.00      0.00      0.00         2
          nb       0.50      0.45      0.48        11
          ne       0.80      0.83      0.82        48
          ob       0.50      0.43      0.46         7
          ra       1.00      0.50      0.67         4
          re       0.50      0.50      0.50         4
          rs       0.46      0.60      0.52        10
          rv       0.67      0.40      0.50         5
          sr       1.00      1.00      1.00         6

   micro avg       0.72      0.73      0.72       605
   macro avg       0.61      0.59      0.59       605
weighted avg       0.71      0.73      0.71       605
 samples avg       0.66      0.65      0.64       605

================================================================================

{'train_runtime': 1214.6815, 'train_samples_per_second': 23.068, 'train_steps_per_second': 1.449, 'train_loss': 0.15619594219959143, 'epoch': 12.0}

===== TEST SET CLASSIFICATION REPORT =====
              precision    recall  f1-score   support

          HI       0.81      0.59      0.68        22
          ID       0.88      0.79      0.84        29
          IN       0.74      0.74      0.74        68
          IP       0.78      0.77      0.78        65
          LY       0.93      0.83      0.88        30
          MT       0.00      0.00      0.00         5
          NA       0.85      0.82      0.84        84
          OP       0.51      0.41      0.45        49
          SP       0.81      0.91      0.86        23
          av       0.43      0.27      0.33        22
          ds       0.71      0.87      0.78        31
         dtp       0.61      0.62      0.62        45
          ed       0.50      0.17      0.25         6
          en       0.00      0.00      0.00         2
          fi       1.00      0.50      0.67         6
          it       0.64      0.82      0.72        11
          lt       0.00      0.00      0.00         2
          nb       0.75      0.27      0.40        11
          ne       0.82      0.66      0.73        47
          ob       0.00      0.00      0.00         8
          ra       1.00      0.80      0.89         5
          re       0.67      1.00      0.80         4
          rs       0.57      0.44      0.50         9
          rv       1.00      0.25      0.40         4
          sr       0.80      0.80      0.80         5

   micro avg       0.75      0.67      0.71       593
   macro avg       0.63      0.53      0.56       593
weighted avg       0.72      0.67      0.69       593
 samples avg       0.66      0.60      0.61       593

Done!
