Split: 16820 train, 4021 dev, 2002 test
Model name:BAAI/bge-m3-retromae
[2025-12-26 23:11:13,816] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-12-26 23:11:19,161] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
{'loss': 0.3174, 'grad_norm': 0.5409751534461975, 'learning_rate': 1.9923954372623575e-05, 'epoch': 1.0}
{'eval_loss': 0.1542954295873642, 'eval_f1_micro': 0.6675324675324675, 'eval_best_threshold': 0.3, 'eval_runtime': 62.746, 'eval_samples_per_second': 64.084, 'eval_steps_per_second': 2.008, 'epoch': 1.0}

================================================================================
Classification report — epoch 1
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.79      0.07      0.12       223
          ID       0.83      0.49      0.61       257
          IN       0.79      0.60      0.68      1107
          IP       0.78      0.70      0.74       676
          LY       0.00      0.00      0.00        45
          MT       0.97      0.19      0.32       181
          NA       0.70      0.92      0.79      1599
          OP       0.63      0.67      0.65       729
          SP       0.00      0.00      0.00        65
          av       0.00      0.00      0.00        98
          ds       0.77      0.76      0.77       490
         dtp       1.00      0.00      0.00       416
          ed       0.00      0.00      0.00        30
          en       0.82      0.86      0.84       138
          fi       0.00      0.00      0.00        41
          it       0.00      0.00      0.00        33
          lt       0.00      0.00      0.00        69
          nb       0.57      0.79      0.66       456
          ne       0.76      0.84      0.79       766
          ob       0.59      0.47      0.52       296
          ra       0.00      0.00      0.00        49
          re       0.00      0.00      0.00        33
          rs       0.00      0.00      0.00        72
          rv       0.79      0.44      0.56       192
          sr       0.91      0.83      0.87       176

   micro avg       0.72      0.62      0.67      8237
   macro avg       0.47      0.35      0.36      8237
weighted avg       0.70      0.62      0.61      8237
 samples avg       0.70      0.63      0.64      8237

================================================================================

{'loss': 0.1304, 'grad_norm': 0.533058226108551, 'learning_rate': 1.7786227291930715e-05, 'epoch': 2.0}
{'eval_loss': 0.11613652855157852, 'eval_f1_micro': 0.7417408075654824, 'eval_best_threshold': 0.35, 'eval_runtime': 62.1867, 'eval_samples_per_second': 64.66, 'eval_steps_per_second': 2.026, 'epoch': 2.0}

================================================================================
Classification report — epoch 2
Best threshold: 0.35
              precision    recall  f1-score   support

          HI       0.73      0.48      0.58       223
          ID       0.89      0.63      0.74       257
          IN       0.79      0.67      0.73      1107
          IP       0.69      0.83      0.75       676
          LY       0.97      0.80      0.88        45
          MT       0.93      0.75      0.83       181
          NA       0.79      0.90      0.84      1599
          OP       0.78      0.58      0.67       729
          SP       0.77      0.31      0.44        65
          av       0.00      0.00      0.00        98
          ds       0.71      0.87      0.78       490
         dtp       0.59      0.35      0.44       416
          ed       0.00      0.00      0.00        30
          en       0.77      0.93      0.85       138
          fi       1.00      0.41      0.59        41
          it       0.74      0.42      0.54        33
          lt       0.80      0.75      0.78        69
          nb       0.62      0.80      0.70       456
          ne       0.82      0.83      0.82       766
          ob       0.63      0.61      0.62       296
          ra       0.90      0.39      0.54        49
          re       1.00      0.91      0.95        33
          rs       0.81      0.83      0.82        72
          rv       0.90      0.59      0.71       192
          sr       0.88      0.88      0.88       176

   micro avg       0.76      0.72      0.74      8237
   macro avg       0.74      0.62      0.66      8237
weighted avg       0.75      0.72      0.73      8237
 samples avg       0.76      0.74      0.73      8237

================================================================================

{'loss': 0.101, 'grad_norm': 1.0426875352859497, 'learning_rate': 1.5564005069708493e-05, 'epoch': 3.0}
{'eval_loss': 0.10714256763458252, 'eval_f1_micro': 0.7585451891497385, 'eval_best_threshold': 0.35, 'eval_runtime': 64.4389, 'eval_samples_per_second': 62.4, 'eval_steps_per_second': 1.955, 'epoch': 3.0}

================================================================================
Classification report — epoch 3
Best threshold: 0.35
              precision    recall  f1-score   support

          HI       0.67      0.58      0.62       223
          ID       0.84      0.76      0.80       257
          IN       0.74      0.76      0.75      1107
          IP       0.81      0.69      0.75       676
          LY       0.97      0.84      0.90        45
          MT       0.93      0.77      0.84       181
          NA       0.83      0.87      0.85      1599
          OP       0.68      0.76      0.72       729
          SP       0.73      0.29      0.42        65
          av       0.58      0.34      0.43        98
          ds       0.81      0.76      0.78       490
         dtp       0.56      0.48      0.51       416
          ed       0.00      0.00      0.00        30
          en       0.82      0.95      0.88       138
          fi       0.83      0.61      0.70        41
          it       0.73      0.48      0.58        33
          lt       0.72      0.90      0.80        69
          nb       0.69      0.80      0.74       456
          ne       0.79      0.85      0.82       766
          ob       0.57      0.67      0.61       296
          ra       0.79      0.47      0.59        49
          re       0.86      0.94      0.90        33
          rs       0.81      0.75      0.78        72
          rv       0.77      0.79      0.78       192
          sr       0.90      0.90      0.90       176

   micro avg       0.76      0.76      0.76      8237
   macro avg       0.74      0.68      0.70      8237
weighted avg       0.76      0.76      0.75      8237
 samples avg       0.78      0.78      0.76      8237

================================================================================

{'loss': 0.0824, 'grad_norm': 0.526337206363678, 'learning_rate': 1.3341782847486271e-05, 'epoch': 4.0}
{'eval_loss': 0.10706818848848343, 'eval_f1_micro': 0.75895977726438, 'eval_best_threshold': 0.3, 'eval_runtime': 62.2459, 'eval_samples_per_second': 64.599, 'eval_steps_per_second': 2.024, 'epoch': 4.0}

================================================================================
Classification report — epoch 4
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.71      0.59      0.64       223
          ID       0.87      0.72      0.78       257
          IN       0.73      0.76      0.75      1107
          IP       0.72      0.78      0.75       676
          LY       0.95      0.80      0.87        45
          MT       0.85      0.91      0.88       181
          NA       0.80      0.89      0.84      1599
          OP       0.71      0.71      0.71       729
          SP       0.72      0.45      0.55        65
          av       0.54      0.46      0.49        98
          ds       0.72      0.82      0.77       490
         dtp       0.53      0.57      0.55       416
          ed       0.00      0.00      0.00        30
          en       0.80      0.97      0.88       138
          fi       0.77      0.66      0.71        41
          it       0.71      0.67      0.69        33
          lt       0.81      0.81      0.81        69
          nb       0.66      0.82      0.73       456
          ne       0.81      0.85      0.83       766
          ob       0.63      0.58      0.61       296
          ra       0.67      0.57      0.62        49
          re       0.88      0.91      0.90        33
          rs       0.78      0.86      0.82        72
          rv       0.76      0.76      0.76       192
          sr       0.86      0.92      0.89       176

   micro avg       0.74      0.78      0.76      8237
   macro avg       0.72      0.71      0.71      8237
weighted avg       0.74      0.78      0.76      8237
 samples avg       0.76      0.79      0.76      8237

================================================================================

{'loss': 0.0676, 'grad_norm': 0.7222710251808167, 'learning_rate': 1.1119560625264048e-05, 'epoch': 5.0}
{'eval_loss': 0.11199566721916199, 'eval_f1_micro': 0.7561080154307758, 'eval_best_threshold': 0.3, 'eval_runtime': 62.1791, 'eval_samples_per_second': 64.668, 'eval_steps_per_second': 2.026, 'epoch': 5.0}

================================================================================
Classification report — epoch 5
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.73      0.43      0.55       223
          ID       0.84      0.80      0.82       257
          IN       0.72      0.77      0.74      1107
          IP       0.79      0.71      0.74       676
          LY       0.93      0.84      0.88        45
          MT       0.86      0.88      0.87       181
          NA       0.82      0.88      0.85      1599
          OP       0.77      0.63      0.69       729
          SP       0.65      0.48      0.55        65
          av       0.55      0.45      0.49        98
          ds       0.81      0.76      0.78       490
         dtp       0.51      0.50      0.50       416
          ed       0.00      0.00      0.00        30
          en       0.71      0.98      0.82       138
          fi       0.77      0.66      0.71        41
          it       0.71      0.76      0.74        33
          lt       0.75      0.83      0.79        69
          nb       0.77      0.77      0.77       456
          ne       0.78      0.86      0.82       766
          ob       0.65      0.50      0.57       296
          ra       0.64      0.71      0.67        49
          re       0.86      0.94      0.90        33
          rs       0.83      0.75      0.79        72
          rv       0.81      0.70      0.75       192
          sr       0.86      0.91      0.89       176

   micro avg       0.76      0.75      0.76      8237
   macro avg       0.72      0.70      0.71      8237
weighted avg       0.76      0.75      0.75      8237
 samples avg       0.77      0.77      0.75      8237

================================================================================

{'loss': 0.0563, 'grad_norm': 0.9221346974372864, 'learning_rate': 8.897338403041825e-06, 'epoch': 6.0}
{'eval_loss': 0.1132134422659874, 'eval_f1_micro': 0.754406580493537, 'eval_best_threshold': 0.39999999999999997, 'eval_runtime': 62.1583, 'eval_samples_per_second': 64.69, 'eval_steps_per_second': 2.027, 'epoch': 6.0}

================================================================================
Classification report — epoch 6
Best threshold: 0.40
              precision    recall  f1-score   support

          HI       0.64      0.63      0.63       223
          ID       0.83      0.81      0.82       257
          IN       0.73      0.75      0.74      1107
          IP       0.74      0.77      0.76       676
          LY       0.95      0.82      0.88        45
          MT       0.90      0.83      0.87       181
          NA       0.83      0.86      0.84      1599
          OP       0.79      0.55      0.65       729
          SP       0.71      0.37      0.48        65
          av       0.60      0.33      0.42        98
          ds       0.75      0.83      0.79       490
         dtp       0.53      0.52      0.53       416
          ed       0.00      0.00      0.00        30
          en       0.88      0.92      0.90       138
          fi       0.70      0.73      0.71        41
          it       0.76      0.58      0.66        33
          lt       0.88      0.71      0.78        69
          nb       0.74      0.79      0.76       456
          ne       0.82      0.83      0.82       766
          ob       0.67      0.42      0.52       296
          ra       0.72      0.59      0.65        49
          re       0.88      0.91      0.90        33
          rs       0.83      0.79      0.81        72
          rv       0.82      0.66      0.73       192
          sr       0.87      0.93      0.90       176

   micro avg       0.77      0.74      0.75      8237
   macro avg       0.74      0.68      0.70      8237
weighted avg       0.76      0.74      0.75      8237
 samples avg       0.77      0.76      0.75      8237

================================================================================

{'loss': 0.0475, 'grad_norm': 0.8772817254066467, 'learning_rate': 6.675116180819603e-06, 'epoch': 7.0}
{'eval_loss': 0.1135626807808876, 'eval_f1_micro': 0.757641247298549, 'eval_best_threshold': 0.39999999999999997, 'eval_runtime': 62.1894, 'eval_samples_per_second': 64.657, 'eval_steps_per_second': 2.026, 'epoch': 7.0}

================================================================================
Classification report — epoch 7
Best threshold: 0.40
              precision    recall  f1-score   support

          HI       0.65      0.65      0.65       223
          ID       0.82      0.77      0.80       257
          IN       0.79      0.70      0.74      1107
          IP       0.71      0.79      0.75       676
          LY       0.95      0.82      0.88        45
          MT       0.87      0.90      0.89       181
          NA       0.84      0.86      0.85      1599
          OP       0.73      0.62      0.67       729
          SP       0.70      0.49      0.58        65
          av       0.56      0.40      0.46        98
          ds       0.76      0.84      0.79       490
         dtp       0.58      0.46      0.51       416
          ed       0.15      0.10      0.12        30
          en       0.88      0.91      0.90       138
          fi       0.73      0.66      0.69        41
          it       0.74      0.70      0.72        33
          lt       0.81      0.80      0.80        69
          nb       0.76      0.77      0.77       456
          ne       0.82      0.84      0.83       766
          ob       0.61      0.48      0.54       296
          ra       0.90      0.39      0.54        49
          re       0.89      0.94      0.91        33
          rs       0.82      0.82      0.82        72
          rv       0.80      0.68      0.74       192
          sr       0.87      0.90      0.89       176

   micro avg       0.77      0.74      0.76      8237
   macro avg       0.75      0.69      0.71      8237
weighted avg       0.77      0.74      0.75      8237
 samples avg       0.78      0.76      0.75      8237

================================================================================

{'train_runtime': 8376.1034, 'train_samples_per_second': 20.081, 'train_steps_per_second': 0.314, 'train_loss': 0.11465476480014683, 'epoch': 7.0}

===== TEST SET CLASSIFICATION REPORT =====
              precision    recall  f1-score   support

          HI       0.55      0.66      0.60       151
          ID       0.65      0.28      0.39       189
          IN       0.58      0.51      0.54       450
          IP       0.79      0.60      0.68       434
          LY       0.86      0.70      0.77       199
          MT       0.54      0.20      0.29        35
          NA       0.68      0.83      0.75       560
          OP       0.55      0.36      0.43       349
          SP       0.92      0.61      0.74       153
          av       0.70      0.22      0.33       146
          ds       0.58      0.69      0.63       208
         dtp       0.70      0.21      0.32       300
          ed       0.75      0.07      0.13        43
          en       0.17      0.08      0.11        12
          fi       1.00      0.04      0.08        46
          it       0.83      0.61      0.70        74
          lt       0.75      0.21      0.33        14
          nb       0.49      0.54      0.51        72
          ne       0.74      0.78      0.76       317
          ob       0.27      0.12      0.17        50
          ra       0.90      0.61      0.73        31
          re       0.55      0.71      0.62        24
          rs       0.60      0.38      0.47        65
          rv       0.38      0.52      0.44        31
          sr       0.83      0.95      0.89        37

   micro avg       0.67      0.54      0.60      3990
   macro avg       0.65      0.46      0.50      3990
weighted avg       0.68      0.54      0.58      3990
 samples avg       0.64      0.51      0.54      3990

Done!
