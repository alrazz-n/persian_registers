Split: 21841 train, 499 dev, 500 test
Model name:FacebookAI/xlm-roberta-large
[2025-12-29 23:20:48,085] [INFO] [real_accelerator.py:254:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-12-29 23:20:50,717] [INFO] [logging.py:107:log_dist] [Rank -1] [TorchCheckpointEngine] Initialized with serialization = False
{'loss': 0.3901, 'grad_norm': 0.36993008852005005, 'learning_rate': 4.985380116959065e-06, 'epoch': 1.0}
{'eval_loss': 0.22151803970336914, 'eval_f1_micro': 0.42962056303549573, 'eval_best_threshold': 0.3, 'eval_runtime': 1.443, 'eval_samples_per_second': 345.803, 'eval_steps_per_second': 11.088, 'epoch': 1.0}

================================================================================
Classification report — epoch 1
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.00      0.00      0.00        39
          ID       0.00      0.00      0.00        47
          IN       0.35      0.71      0.47       107
          IP       0.59      0.62      0.60       109
          LY       0.00      0.00      0.00        50
          MT       0.00      0.00      0.00         8
          NA       0.64      0.85      0.73       139
          OP       1.00      0.01      0.02        86
          SP       0.00      0.00      0.00        38
          av       0.00      0.00      0.00        38
          ds       0.60      0.55      0.57        53
         dtp       0.00      0.00      0.00        70
          ed       0.00      0.00      0.00        11
          en       0.00      0.00      0.00         3
          fi       0.00      0.00      0.00        11
          it       0.00      0.00      0.00        19
          lt       0.00      0.00      0.00         3
          nb       1.00      0.06      0.11        17
          ne       0.72      0.75      0.73        77
          ob       0.00      0.00      0.00        12
          ra       0.00      0.00      0.00         7
          re       0.00      0.00      0.00         6
          rs       0.00      0.00      0.00        18
          rv       0.00      0.00      0.00         7
          sr       0.00      0.00      0.00         9

   micro avg       0.54      0.36      0.43       984
   macro avg       0.20      0.14      0.13       984
weighted avg       0.39      0.36      0.31       984
 samples avg       0.42      0.33      0.34       984

================================================================================

{'loss': 0.1652, 'grad_norm': 0.5695933699607849, 'learning_rate': 9.985380116959065e-06, 'epoch': 2.0}
{'eval_loss': 0.16550453007221222, 'eval_f1_micro': 0.5894039735099338, 'eval_best_threshold': 0.3, 'eval_runtime': 1.3996, 'eval_samples_per_second': 356.518, 'eval_steps_per_second': 11.431, 'epoch': 2.0}

================================================================================
Classification report — epoch 2
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.64      0.74      0.69        39
          ID       0.68      0.36      0.47        47
          IN       0.49      0.65      0.56       107
          IP       0.90      0.43      0.58       109
          LY       0.93      0.74      0.82        50
          MT       0.80      0.50      0.62         8
          NA       0.74      0.79      0.76       139
          OP       0.47      0.66      0.55        86
          SP       0.00      0.00      0.00        38
          av       1.00      0.24      0.38        38
          ds       0.69      0.55      0.61        53
         dtp       0.60      0.30      0.40        70
          ed       0.00      0.00      0.00        11
          en       0.00      0.00      0.00         3
          fi       0.00      0.00      0.00        11
          it       0.00      0.00      0.00        19
          lt       0.00      0.00      0.00         3
          nb       0.79      0.65      0.71        17
          ne       0.74      0.83      0.78        77
          ob       0.50      0.67      0.57        12
          ra       0.00      0.00      0.00         7
          re       1.00      0.50      0.67         6
          rs       0.32      0.33      0.32        18
          rv       0.67      0.86      0.75         7
          sr       0.75      0.67      0.71         9

   micro avg       0.64      0.54      0.59       984
   macro avg       0.51      0.42      0.44       984
weighted avg       0.63      0.54      0.56       984
 samples avg       0.60      0.50      0.52       984

================================================================================

{'loss': 0.1218, 'grad_norm': 0.592286229133606, 'learning_rate': 9.446068875893438e-06, 'epoch': 3.0}
{'eval_loss': 0.13814644515514374, 'eval_f1_micro': 0.6746987951807228, 'eval_best_threshold': 0.3, 'eval_runtime': 1.399, 'eval_samples_per_second': 356.689, 'eval_steps_per_second': 11.437, 'epoch': 3.0}

================================================================================
Classification report — epoch 3
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.72      0.67      0.69        39
          ID       0.76      0.40      0.53        47
          IN       0.64      0.64      0.64       107
          IP       0.81      0.54      0.65       109
          LY       0.95      0.72      0.82        50
          MT       0.71      0.62      0.67         8
          NA       0.70      0.92      0.80       139
          OP       0.67      0.50      0.57        86
          SP       0.91      0.76      0.83        38
          av       0.94      0.45      0.61        38
          ds       0.73      0.72      0.72        53
         dtp       0.73      0.43      0.54        70
          ed       0.00      0.00      0.00        11
          en       0.00      0.00      0.00         3
          fi       0.00      0.00      0.00        11
          it       0.85      0.58      0.69        19
          lt       0.00      0.00      0.00         3
          nb       0.55      0.71      0.62        17
          ne       0.75      0.86      0.80        77
          ob       0.00      0.00      0.00        12
          ra       1.00      0.71      0.83         7
          re       1.00      0.83      0.91         6
          rs       0.44      0.39      0.41        18
          rv       1.00      0.86      0.92         7
          sr       0.75      0.67      0.71         9

   micro avg       0.73      0.63      0.67       984
   macro avg       0.62      0.52      0.56       984
weighted avg       0.72      0.63      0.65       984
 samples avg       0.66      0.58      0.59       984

================================================================================

{'loss': 0.102, 'grad_norm': 2.1846301555633545, 'learning_rate': 8.890513320337882e-06, 'epoch': 4.0}
{'eval_loss': 0.13052232563495636, 'eval_f1_micro': 0.6934886183165696, 'eval_best_threshold': 0.3, 'eval_runtime': 1.3979, 'eval_samples_per_second': 356.972, 'eval_steps_per_second': 11.446, 'epoch': 4.0}

================================================================================
Classification report — epoch 4
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.71      0.69      0.70        39
          ID       0.86      0.53      0.66        47
          IN       0.61      0.83      0.70       107
          IP       0.75      0.67      0.71       109
          LY       0.91      0.80      0.85        50
          MT       0.43      0.38      0.40         8
          NA       0.87      0.80      0.83       139
          OP       0.75      0.44      0.55        86
          SP       0.71      0.89      0.79        38
          av       1.00      0.45      0.62        38
          ds       0.57      0.75      0.65        53
         dtp       0.65      0.59      0.62        70
          ed       0.00      0.00      0.00        11
          en       0.00      0.00      0.00         3
          fi       0.00      0.00      0.00        11
          it       0.47      0.79      0.59        19
          lt       0.00      0.00      0.00         3
          nb       0.62      0.59      0.61        17
          ne       0.82      0.83      0.83        77
          ob       1.00      0.08      0.15        12
          ra       0.83      0.71      0.77         7
          re       1.00      0.50      0.67         6
          rs       0.55      0.33      0.41        18
          rv       0.86      0.86      0.86         7
          sr       0.58      0.78      0.67         9

   micro avg       0.72      0.67      0.69       984
   macro avg       0.62      0.53      0.55       984
weighted avg       0.73      0.67      0.68       984
 samples avg       0.65      0.61      0.60       984

================================================================================

{'loss': 0.088, 'grad_norm': 2.3454718589782715, 'learning_rate': 8.334957764782326e-06, 'epoch': 5.0}
{'eval_loss': 0.12409493327140808, 'eval_f1_micro': 0.7137662337662337, 'eval_best_threshold': 0.3, 'eval_runtime': 1.398, 'eval_samples_per_second': 356.935, 'eval_steps_per_second': 11.445, 'epoch': 5.0}

================================================================================
Classification report — epoch 5
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.67      0.85      0.75        39
          ID       0.86      0.53      0.66        47
          IN       0.63      0.75      0.69       107
          IP       0.74      0.69      0.71       109
          LY       0.88      0.88      0.88        50
          MT       0.50      0.38      0.43         8
          NA       0.84      0.88      0.86       139
          OP       0.68      0.58      0.62        86
          SP       1.00      0.68      0.81        38
          av       0.86      0.63      0.73        38
          ds       0.61      0.75      0.67        53
         dtp       0.60      0.57      0.58        70
          ed       0.00      0.00      0.00        11
          en       0.00      0.00      0.00         3
          fi       0.00      0.00      0.00        11
          it       0.85      0.58      0.69        19
          lt       0.00      0.00      0.00         3
          nb       0.67      0.59      0.62        17
          ne       0.80      0.91      0.85        77
          ob       0.67      0.17      0.27        12
          ra       0.83      0.71      0.77         7
          re       0.80      0.67      0.73         6
          rs       0.45      0.50      0.47        18
          rv       0.67      0.86      0.75         7
          sr       0.70      0.78      0.74         9

   micro avg       0.73      0.70      0.71       984
   macro avg       0.61      0.56      0.57       984
weighted avg       0.72      0.70      0.70       984
 samples avg       0.67      0.63      0.62       984

================================================================================

{'loss': 0.0761, 'grad_norm': 0.5314053297042847, 'learning_rate': 7.779402209226771e-06, 'epoch': 6.0}
{'eval_loss': 0.12397591769695282, 'eval_f1_micro': 0.7088607594936709, 'eval_best_threshold': 0.3, 'eval_runtime': 1.3986, 'eval_samples_per_second': 356.798, 'eval_steps_per_second': 11.44, 'epoch': 6.0}

================================================================================
Classification report — epoch 6
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.62      0.79      0.70        39
          ID       0.84      0.55      0.67        47
          IN       0.67      0.74      0.70       107
          IP       0.69      0.77      0.73       109
          LY       0.84      0.84      0.84        50
          MT       0.50      0.38      0.43         8
          NA       0.88      0.83      0.86       139
          OP       0.72      0.62      0.66        86
          SP       0.80      0.87      0.84        38
          av       0.80      0.63      0.71        38
          ds       0.59      0.85      0.70        53
         dtp       0.57      0.54      0.55        70
          ed       0.25      0.18      0.21        11
          en       0.00      0.00      0.00         3
          fi       0.75      0.27      0.40        11
          it       0.57      0.68      0.62        19
          lt       0.00      0.00      0.00         3
          nb       0.60      0.53      0.56        17
          ne       0.80      0.87      0.83        77
          ob       0.67      0.17      0.27        12
          ra       0.86      0.86      0.86         7
          re       0.80      0.67      0.73         6
          rs       0.39      0.39      0.39        18
          rv       0.67      0.86      0.75         7
          sr       0.70      0.78      0.74         9

   micro avg       0.71      0.71      0.71       984
   macro avg       0.62      0.59      0.59       984
weighted avg       0.71      0.71      0.70       984
 samples avg       0.65      0.64      0.62       984

================================================================================

{'loss': 0.0664, 'grad_norm': 0.7683055400848389, 'learning_rate': 7.223846653671216e-06, 'epoch': 7.0}
{'eval_loss': 0.11975941807031631, 'eval_f1_micro': 0.7300303336703741, 'eval_best_threshold': 0.3, 'eval_runtime': 1.3986, 'eval_samples_per_second': 356.775, 'eval_steps_per_second': 11.44, 'epoch': 7.0}

================================================================================
Classification report — epoch 7
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.73      0.69      0.71        39
          ID       0.92      0.51      0.66        47
          IN       0.67      0.82      0.74       107
          IP       0.70      0.73      0.71       109
          LY       0.83      0.96      0.89        50
          MT       0.57      0.50      0.53         8
          NA       0.88      0.82      0.85       139
          OP       0.65      0.69      0.67        86
          SP       0.89      0.89      0.89        38
          av       0.79      0.68      0.73        38
          ds       0.68      0.77      0.73        53
         dtp       0.56      0.70      0.62        70
          ed       0.33      0.27      0.30        11
          en       0.00      0.00      0.00         3
          fi       0.80      0.73      0.76        11
          it       0.81      0.68      0.74        19
          lt       0.00      0.00      0.00         3
          nb       0.80      0.47      0.59        17
          ne       0.77      0.88      0.82        77
          ob       0.25      0.08      0.12        12
          ra       0.83      0.71      0.77         7
          re       0.80      0.67      0.73         6
          rs       0.46      0.33      0.39        18
          rv       0.67      0.86      0.75         7
          sr       0.75      0.67      0.71         9

   micro avg       0.73      0.73      0.73       984
   macro avg       0.65      0.61      0.62       984
weighted avg       0.73      0.73      0.72       984
 samples avg       0.67      0.65      0.64       984

================================================================================

{'loss': 0.0586, 'grad_norm': 2.133920431137085, 'learning_rate': 6.6682910981156605e-06, 'epoch': 8.0}
{'eval_loss': 0.12205091863870621, 'eval_f1_micro': 0.7228541882109617, 'eval_best_threshold': 0.3, 'eval_runtime': 1.3979, 'eval_samples_per_second': 356.971, 'eval_steps_per_second': 11.446, 'epoch': 8.0}

================================================================================
Classification report — epoch 8
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.78      0.64      0.70        39
          ID       0.86      0.51      0.64        47
          IN       0.63      0.86      0.72       107
          IP       0.73      0.71      0.72       109
          LY       0.87      0.92      0.89        50
          MT       0.50      0.50      0.50         8
          NA       0.88      0.81      0.84       139
          OP       0.70      0.59      0.64        86
          SP       0.80      0.87      0.84        38
          av       0.84      0.55      0.67        38
          ds       0.82      0.77      0.80        53
         dtp       0.54      0.66      0.59        70
          ed       0.43      0.27      0.33        11
          en       0.00      0.00      0.00         3
          fi       0.89      0.73      0.80        11
          it       0.71      0.63      0.67        19
          lt       0.00      0.00      0.00         3
          nb       0.73      0.65      0.69        17
          ne       0.79      0.84      0.82        77
          ob       0.33      0.08      0.13        12
          ra       1.00      0.71      0.83         7
          re       0.80      0.67      0.73         6
          rs       0.43      0.33      0.38        18
          rv       0.75      0.86      0.80         7
          sr       0.75      0.67      0.71         9

   micro avg       0.74      0.71      0.72       984
   macro avg       0.66      0.59      0.62       984
weighted avg       0.74      0.71      0.72       984
 samples avg       0.67      0.64      0.63       984

================================================================================

{'loss': 0.0515, 'grad_norm': 1.7296059131622314, 'learning_rate': 6.112735542560104e-06, 'epoch': 9.0}
{'eval_loss': 0.12363733351230621, 'eval_f1_micro': 0.7285714285714285, 'eval_best_threshold': 0.3, 'eval_runtime': 1.3988, 'eval_samples_per_second': 356.745, 'eval_steps_per_second': 11.439, 'epoch': 9.0}

================================================================================
Classification report — epoch 9
Best threshold: 0.30
              precision    recall  f1-score   support

          HI       0.74      0.67      0.70        39
          ID       0.74      0.55      0.63        47
          IN       0.72      0.77      0.74       107
          IP       0.66      0.82      0.73       109
          LY       0.85      0.90      0.87        50
          MT       0.57      0.50      0.53         8
          NA       0.86      0.83      0.84       139
          OP       0.66      0.64      0.65        86
          SP       0.94      0.84      0.89        38
          av       0.76      0.68      0.72        38
          ds       0.74      0.81      0.77        53
         dtp       0.61      0.60      0.60        70
          ed       0.36      0.36      0.36        11
          en       0.00      0.00      0.00         3
          fi       0.80      0.73      0.76        11
          it       0.75      0.63      0.69        19
          lt       0.00      0.00      0.00         3
          nb       0.67      0.59      0.62        17
          ne       0.78      0.87      0.82        77
          ob       0.33      0.17      0.22        12
          ra       1.00      0.71      0.83         7
          re       0.80      0.67      0.73         6
          rs       0.45      0.28      0.34        18
          rv       0.67      0.86      0.75         7
          sr       0.75      0.67      0.71         9

   micro avg       0.73      0.73      0.73       984
   macro avg       0.65      0.61      0.62       984
weighted avg       0.73      0.73      0.72       984
 samples avg       0.67      0.65      0.64       984

================================================================================

{'loss': 0.0452, 'grad_norm': 1.94465172290802, 'learning_rate': 5.557179987004548e-06, 'epoch': 10.0}
{'eval_loss': 0.129797101020813, 'eval_f1_micro': 0.7207403375068046, 'eval_best_threshold': 0.49999999999999994, 'eval_runtime': 1.3977, 'eval_samples_per_second': 357.007, 'eval_steps_per_second': 11.447, 'epoch': 10.0}

================================================================================
Classification report — epoch 10
Best threshold: 0.50
              precision    recall  f1-score   support

          HI       0.78      0.64      0.70        39
          ID       0.92      0.47      0.62        47
          IN       0.69      0.75      0.72       107
          IP       0.77      0.68      0.72       109
          LY       0.85      0.92      0.88        50
          MT       1.00      0.25      0.40         8
          NA       0.89      0.79      0.84       139
          OP       0.72      0.58      0.65        86
          SP       1.00      0.68      0.81        38
          av       0.87      0.53      0.66        38
          ds       0.83      0.75      0.79        53
         dtp       0.58      0.64      0.61        70
          ed       0.75      0.27      0.40        11
          en       0.00      0.00      0.00         3
          fi       1.00      0.73      0.84        11
          it       0.92      0.58      0.71        19
          lt       0.00      0.00      0.00         3
          nb       0.67      0.47      0.55        17
          ne       0.81      0.84      0.83        77
          ob       0.00      0.00      0.00        12
          ra       1.00      0.71      0.83         7
          re       0.80      0.67      0.73         6
          rs       0.38      0.33      0.35        18
          rv       0.86      0.86      0.86         7
          sr       0.75      0.67      0.71         9

   micro avg       0.78      0.67      0.72       984
   macro avg       0.71      0.55      0.61       984
weighted avg       0.78      0.67      0.71       984
 samples avg       0.68      0.61      0.62       984

================================================================================

{'train_runtime': 2966.1706, 'train_samples_per_second': 147.267, 'train_steps_per_second': 2.306, 'train_loss': 0.11648779696191264, 'epoch': 10.0}

===== TEST SET CLASSIFICATION REPORT =====
              precision    recall  f1-score   support

          HI       0.81      0.65      0.72        34
          ID       0.71      0.52      0.60        48
          IN       0.62      0.73      0.67       107
          IP       0.78      0.63      0.70       109
          LY       0.84      0.86      0.85        50
          MT       0.67      0.50      0.57         8
          NA       0.89      0.77      0.83       140
          OP       0.59      0.48      0.53        87
          SP       0.89      0.63      0.74        38
          av       0.55      0.46      0.50        37
          ds       0.76      0.72      0.74        53
         dtp       0.54      0.63      0.58        71
          ed       0.40      0.20      0.27        10
          en       0.00      0.00      0.00         3
          fi       0.67      0.50      0.57         8
          it       0.78      0.37      0.50        19
          lt       1.00      0.67      0.80         3
          nb       0.69      0.50      0.58        18
          ne       0.88      0.82      0.85        77
          ob       0.20      0.08      0.12        12
          ra       0.75      0.38      0.50         8
          re       1.00      1.00      1.00         6
          rs       0.40      0.27      0.32        15
          rv       0.70      1.00      0.82         7
          sr       0.83      1.00      0.91        10

   micro avg       0.73      0.65      0.68       978
   macro avg       0.68      0.57      0.61       978
weighted avg       0.73      0.65      0.68       978
 samples avg       0.65      0.59      0.60       978

Done!
